{% if TUTOR_VERSION is defined and PICASSO_THEME_DIRS is defined and PICASSO_THEMES_NAME is defined %}

COPY --chown=app:app ./themes/ /openedx/themes
# This compiles the Picasso themes assets from the redwood release.

# These commands are already in the Dockerfile Tutor template,
# but we needed them for the Picasso themes compilation.
RUN npm run postinstall
RUN npm run compile-sass -- --skip-themes
RUN npm run webpack
# Compiling the Picasso themes.
RUN npm run compile-sass -- \
    --theme-dir {{ PICASSO_THEME_DIRS | join(' --theme-dir ') }} \
    --theme {{ PICASSO_THEMES_NAME | join(' --theme ') }} \
    && ./manage.py lms collectstatic --noinput --settings=tutor.assets \
    && rdfind -makesymlinks true -followsymlinks true /openedx/staticfiles/
{% endif %}
